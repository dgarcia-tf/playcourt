import { createCalendarEventsModule } from './features/calendar/events.js';
import { createCalendarModule } from './features/calendar/calendar.js';


const calendarEventsModule = createCalendarEventsModule({
  startOfDay,
  addDays,
  addMinutes,
  formatTimeRangeLabel,
  formatCourtDisplay,
  formatReservationParticipantsLabel,
  getReservationMatch,
  formatMatchPlayersLabel,
  getReservationContextLabel,
  normalizeId,
  getPlayerDisplayName,
  normalizeCourtKey,
  getClubCourtNames,
  formatDateInput,
  formatDateOnly,
  formatDayLabel,
  getReservationSlotStartsForDate,
  getReservationSlotEnd,
  formatReservationSlotLabel,
  openReservationEditorFromCalendar,
  bindCalendarEvent,
  openTournamentMatchScheduleModal,
  parseDateSafe,
  COURT_RESERVATION_DEFAULT_DURATION,
  getSelectedCourtCalendarDate: () => state.courtCalendarDate,
});

const {
  buildPlayerCourtCalendarEvents,
  getCourtCalendarCourts,
  createCourtCalendarEvent,
  getCourtCalendarEventBounds,
  isCourtCalendarEventForCourt,
  doesCourtCalendarEventOverlapSlot,
} = calendarEventsModule;

const calendarModule = createCalendarModule({
  state,
  playerCourtCalendarContainer,
  playerCourtCalendarLabel,
  playerCourtCalendarDateInput,
  courtCalendarContainer,
  courtCalendarLabel,
  courtCalendarStatus,
  courtCalendarViewButtons,
  courtBlocksList,
  courtBlocksEmpty,
  courtAdminDateInput,
  setStatusMessage,
  formatDateInput,
  formatDayLabel,
  formatMonthLabel,
  formatDateRangeLabel,
  formatTimeRangeLabel,
  startOfDay,
  startOfMonth,
  endOfMonth,
  addDays,
  hasCourtManagementAccess,
  setCalendarViewButtonState,
  request,
  formatReservationParticipantsLabel,
  getReservationMatch,
  getPlayerDisplayName,
  getReservationContextLabel,
  normalizeId,
  ensureCourtBlockRangeDefaults,
  showSection,
  refreshCourtAvailability,
  calendarEvents: calendarEventsModule,
});

const {
  renderPlayerCourtCalendar,
  renderCourtCalendar,
  setCourtCalendarViewMode,
  resetCourtCalendarView,
  renderCourtBlocksList,
  loadCourtCalendarData,
  handleCourtCalendarDaySelection,
} = calendarModule;
