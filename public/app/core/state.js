import {
  PUSH_SUPPORTED,
  TOURNAMENT_ENROLLMENT_ALL_OPTION,
} from '../config/constants.js';

export function createAppState(overrides = {}) {
  const baseState = {
    token: null,
    user: null,
    categories: [],
    categoriesLoaded: false,
    leagues: [],
    players: [],
    myMatches: [],
    upcomingMatches: [],
    pendingApprovalMatches: [],
    completedMatches: [],
    selectedCategoryId: null,
    selectedLeagueId: '',
    selectedApp: 'tennis',
    rankingFilters: { league: '' },
    needsSetup: false,
    accountSummary: null,
    accountSummaryLoading: false,
    enrollments: new Map(),
    enrollmentRequests: new Map(),
    tournaments: [],
    tournamentDetails: new Map(),
    selectedTournamentId: '',
    selectedTournamentCategoriesId: '',
    selectedEnrollmentTournamentId: '',
    selectedEnrollmentCategoryId: TOURNAMENT_ENROLLMENT_ALL_OPTION,
    selectedMatchTournamentId: '',
    selectedMatchCategoryId: '',
    selectedOrderOfPlayDay: '',
    selectedDoublesTournamentId: '',
    selectedBracketTournamentId: '',
    selectedBracketCategoryId: '',
    tournamentEnrollments: new Map(),
    tournamentEnrollmentFilters: {
      search: '',
      gender: '',
    },
    tournamentMatches: new Map(),
    tournamentOrderOfPlayDays: new Map(),
    tournamentBracketMatches: new Map(),
    tournamentBracketAlignmentCallbacks: new Set(),
    tournamentBracketResizeHandler: null,
    tournamentPayments: new Map(),
    tournamentDoubles: new Map(),
    tournamentDoublesPairs: new Map(),
    tournamentPaymentFilters: {
      tournament: '',
      search: '',
    },
    tournamentPaymentsLoading: false,
    activeSection: 'section-dashboard',
    globalOverview: null,
    leagueDashboard: null,
    leagueDashboardPlayersPage: 1,
    tournamentDashboard: null,
    calendarMatches: [],
    calendarDate: new Date(),
    globalCalendarDate: new Date(),
    globalCalendarViewMode: 'month',
    matchPagination: {
      upcoming: {},
      pending: {},
      completed: {},
    },
    adminCategoryEditingId: null,
    adminPlayerEditingId: null,
    adminMatchEditingId: null,
    seasons: [],
    club: null,
    rankingsByCategory: new Map(),
    rankingsLoading: false,
    generalChatMessages: [],
    noticeUnreadCount: 0,
    tournamentBracketSeedsDirty: false,
    playerDirectoryFilters: {
      search: '',
      gender: '',
      role: '',
      category: '',
    },
    leaguePlayersFilters: {
      league: '',
      category: '',
      search: '',
      gender: '',
    },
    categoryFilters: {
      league: '',
    },
    leaguePlayersLoading: false,
    leagueDetails: new Map(),
    leaguePayments: new Map(),
    leaguePaymentFilters: {
      league: '',
      search: '',
    },
    leaguePaymentsLoading: false,
    courtReservations: [],
    courtAvailability: [],
    courtAvailabilityDate: new Date(),
    courtAvailabilityCourt: '',
    courtAvailabilityIgnoreManualLimit: false,
    courtAdminDate: new Date(),
    courtAdminCourt: '',
    courtAdminSchedule: [],
    courtAdminBlocks: [],
    courtAdminIgnoreManualLimit: false,
    courtCalendarDate: new Date(),
    courtCalendarEvents: [],
    courtCalendarViewMode: 'month',
    playerCourtCalendarDate: new Date(),
    courtBlocks: [],
    reservationPlayers: [],
    push: {
      supported: PUSH_SUPPORTED,
      permission: PUSH_SUPPORTED ? Notification.permission : 'default',
      enabled: false,
      configLoaded: false,
      serverEnabled: false,
      publicKey: null,
      subscriptionEndpoint: null,
      loading: false,
    },
  };

  if (overrides && typeof overrides === 'object') {
    Object.assign(baseState, overrides);
  }

  return baseState;
}
